# 个人自用漫画分类脚本

这是一个我个人使用的 Bash 脚本，用于实现漫画文件按作者创建文件夹并进行分类

# ⌨️ 在您想要安装的机器上，进入目标目录，执行以下命令即可：
```
source <(curl -sL https://raw.githubusercontent.com/wk4796/fenlei/main/install_fenlei.sh)
```
### 脚本别名为：`fenlei`
直接输入`fenlei`就可以进入脚本

# fenlei.sh - 漫画自动分类脚本 📂

![Made with Bash](https://img.shields.io/badge/Made%20with-Bash-blue.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg) 这是一个高效、健壮的 Bash 脚本，用于自动扫描和分类漫画/插画集文件。

它会读取文件名中 `[` 和 `]` 括号内的作者/来源信息，并将文件移动到以该信息命名的文件夹中。

## 🚀 核心功能

* **智能提取**: 自动解析 `[作者(来源)]` 和 `[作者]` 两种常见的文件名模式。
* **交互模式**: 如果不带参数运行，脚本将进入交互模式，引导您输入目录和选项。
* **灵活阈值**: 可在交互模式下临时设置“最小文件数”（默认为 2），只有当文件数达到阈值时才创建*新*文件夹。
* **子文件夹扫描**: 可选“扫描子文件夹”模式（交互式开启），用于查找并整理所有子目录中的文件。
* **高性能**:
    * 使用 `find` 命令进行文件扫描，即使在包含数十万个文件的目录中也能保持高性能和低内存占用。
    * 内置 `sed` 结果缓存，在处理大量同作者文件时显著提升索引速度。
* **试运行 (Dry Run)**: 提供 `-n` / `--dry-run` 模式，只打印将要执行的操作，不实际移动任何文件，方便预览。
* **健壮性**: 对 `mkdir` 和 `mv` 操作进行错误检查，单个文件I/O失败不会导致整个脚本退出。
* **详细报告**: 操作完成后，提供清晰的总结报告（创建了哪些文件夹、更新了哪些、跳过了哪些）。

## ⚙️ 需求

* **Bash 4.0+**: 脚本严重依赖 Bash 4.0 及以上版本提供的**关联数组 (`declare -A`)** 和 `mapfile`。
* **核心工具**: `find`, `sed`, `mv`, `basename` (这些工具在所有现代 Linux / macOS 系统中都已内置)。

## 💡 它是如何工作的？ (分类逻辑)

脚本通过两个正则表达式（Regex）来提取文件夹名称（"标签"）：

1.  **规则 1 (优先): `[作者(来源)]`**
    * 文件名: `[Alice(C99)] My Comic.zip`
    * 脚本会优先提取括号 `()` 内的内容。
    * 提取的标签: `C99`
    * 文件将被移动到: `[目标目录]/C99/`

2.  **规则 2 (备选): `[作者]`**
    * 文件名: `[Bob] Another Comic.zip`
    * 如果 `[]` 内没有 `()`，脚本会提取 `[]` 内的全部内容。
    * 提取的标签: `Bob`
    * 文件将被移动到: `[目标目录]/Bob/`
